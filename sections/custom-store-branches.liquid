{%- style -%}
      .custom-branch__header {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: space-between;
        align-items: center;
        gap: 20px;
    }

    .custom-branch__body {
          display: flex;
          gap: 20px;
          justify-content: center;
          align-items: center;
          flex-wrap: wrap;
      }

      .custom-branch__items {
        flex: 1 0 100%;
        text-align:center;
      }

      .custom-branch__items_wrapper{
      position: relative;
      padding: 1rem;
      background: var(--zekoki-primary);
      border-radius: 1rem;
    }

      .custom-branch__items_wrapper h2 {
        background: var(--zekoki-primary);
        color: var(--zekoki-white);
        padding: 20px;
        width:100%;
        margin: 0 !important;
    }

    .pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-top: 20px;
        gap: 5px;
    }

    .pagination button {
        padding: 8px 12px;
        border: 1px solid #ccc;
        background: white;
        cursor: pointer;
        border-radius: 5px;
        transition: all 0.3s ease;
    }

    .pagination button:hover {
        background-color: #e0e0e0;
    }

    .pagination .current {
        background: var(--zekoki-primary);
        color: var(--zekoki-white);
        font-weight: bold;
    }

    /* Tablet and small desktop */
  @media screen and (min-width: 750px) {
      .custom-branch__items {
        flex: 1 0 30%;
      }
  }
{%- endstyle -%}

<section
  class="page-width custom-branch__section scroll-trigger animate--slide-in"
  style="
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
  "
>
  <div class="custom-branch__container">
    <div class="custom-branch__header">
      <div class="custom_branch__header--container">
        <h2 class="h1 title">{{ section.settings['custom-branch__title'] }}</h2>
      </div>
      <div class="custom_branch__header--container">
        <p>{{ section.settings['custom-branch__description'] }}</p>
      </div>
    </div>

    <div class="custom-branch__body" id="branch-items-container">
      {% for branch in shop.metaobjects.zekoki_store_branches.values %}
        <div class="custom-branch__items branch-item" style="display: none;">
          <div class="custom-branch__items_wrapper">
            {% if branch.photo != blank %}
              <img src="{{ branch.photo | image_url }}" alt="{{ branch.title }}" height="" width="">
            {% endif %}
            <h3 style="color: var(--zekoki-white);">{{ branch.title }}</h3>
          </div>
          <p>{{ branch.location }}</p>
          <a
            href="
              {% if page.handle == 'branches' %}
                  zekoki-store-branches/{{ branch.system.handle }}
              {% else %}
                 pages/zekoki-store-branches/{{ branch.system.handle }}
              {% endif %}
            "
            class="button button--primary"
          >
            Branch Details
          </a>
        </div>
      {% endfor %}
    </div>
    <div class="pagination" id="pagination-controls-branches"></div>
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    function setupPagination(itemsClass, containerId) {
      const items = document.querySelectorAll(itemsClass);
      const itemsPerPage = 6;
      let currentPage = 1;

      function showPage(page) {
        const start = (page - 1) * itemsPerPage;
        const end = start + itemsPerPage;
        items.forEach((item, index) => {
          item.style.display = index >= start && index < end ? "flex" : "none";
        });
        updatePaginationControls(page);
      }

      function updatePaginationControls(page) {
        const totalPages = Math.ceil(items.length / itemsPerPage);
        const paginationContainer = document.getElementById(containerId);
        paginationContainer.innerHTML = "";

        if (totalPages > 1) {
          if (page > 1) {
            paginationContainer.innerHTML += `<button onclick="changePage(${page - 1}, '${containerId}')">&laquo; Prev</button>`;
          }
          for (let i = 1; i <= totalPages; i++) {
            paginationContainer.innerHTML += `<button class="${i === page ? 'current' : ''}" onclick="changePage(${i}, '${containerId}')">${i}</button>`;
          }
          if (page < totalPages) {
            paginationContainer.innerHTML += `<button onclick="changePage(${page + 1}, '${containerId}')">Next &raquo;</button>`;
          }
        }
      }

      window.changePage = function (page, container) {
        if (container === containerId) {
          currentPage = page;
          showPage(page);
        }
      };

      showPage(currentPage);
    }

    setupPagination(".branch-item", "pagination-controls-branches");
  });
</script>

{% schema %}
{
  "name": "Custom Branches Section",
  "settings": [
  {
    "type": "header",
    "content": "Section Spacing"
  },
  {
    "type": "range",
    "id": "padding_top",
    "label": "Padding Top",
    "min": 0,
    "max": 100,
    "step": 5,
    "default": 20
  },
  {
    "type": "range",
    "id": "padding_bottom",
    "label": "Padding Bottom",
    "min": 0,
    "max": 100,
    "step": 5,
    "default": 20
  },
  {
    "type": "header",
    "content": "branch Details"
  },
  {
    "type": "text",
    "id": "custom-branch__title",
    "label": "branch Title",
    "default": "Quality Products"
  },
  {
    "type": "textarea",
    "id": "custom-branch__description",
    "label": "branch Description",
    "default": "Product that you will truly love"
  },
  ],
  "presets": [
    {
      "name": "Custom Store Branches Section"
    }
  ]
}
{% endschema %}
